/**
 * åˆå¹¶æ“ä½œç¬¦ï¼šå°†å¤šä¸ªObservableåˆå¹¶åˆ°ä¸€èµ·çš„æ“ä½œç¬¦ï¼ŒçŠ¹å¦‚ä¼—å¤šå°æºªæ±‡å…¥æ±Ÿæ²³
 *    concat
 *    concatAll
 *    merge
 *    mergeAll
 *    zip
 *    zipAll
 *    combineLatest
 *    combineAll
 *    withLatestFrom
 *    race
 *    startWith
 *    forkJoin
 *    switch
 *    exhaust
 */
import {interval} from 'rxjs/observable/interval'
import {outilObserver} from './outilObserver'
import {
  oaOf$,
  oaInterval$
} from './creatOperators'
import { 
  map,
  concat,
  withLatestFrom,
  startWith,
  take
} from 'rxjs/operators'
import { merge, zip, combineLatest, timer, race, forkJoin, of } from 'rxjs'
// import {concat} from 'rxjs/observable/concat'

/**
 * 1ã€concatï¼šæœ€ç®€å•çš„åˆå¹¶ï¼Œå³é¦–å°¾åˆå¹¶ï¼Œæœ‰é™æ€ä¹Ÿæœ‰å®ä¾‹æ“ä½œç¬¦
 * of$: (1ã€xzxã€2)|->
 * interval: ----0----1----2|->
 * concat: (1ã€xzxã€2)----0----1----2|->
 */
var oaConcat$ = oaOf$.pipe(concat(oaInterval$))
// var oaConcat$ = concat(oaOf$, oaInterval$) // é™æ€æ–¹æ³•
// oaConcat$.subscribe(outilObserver) 

/**
 * 2ã€mergeï¼šå…ˆåˆ°å…ˆå¾—ï¼Œå¿«é€Ÿé€šè¿‡ã€‚
 *    mergeä¼šç¬¬ä¸€æ—¶é—´è®¢é˜…ä¸Šæ¸¸æ‰€æœ‰çš„Observableï¼Œç„¶åå¯¹ä¸Šæ¸¸æ•°æ®é‡‡å–å…ˆåˆ°å…ˆå¾—ç­–ç•¥ï¼Œï¼ï¼ï¼â€œåªè¦æœ‰ä»»ä½•ä¸€ä¸ªObservableæœ‰æ•°æ®ä¸‹æ¥ï¼Œé‚£ä¹ˆmergeå°±åå‡ºä¸€æ¬¡æ•°æ®ï¼Œå°†å…¶è½¬äº¤ä¸‹æ¸¸â€
 *  å¦‚ä¸‹é¢ä¾‹å­çš„å¼¹ç å›¾
 *  i1: --0--1--2...->
 *  i1Map: --0A--1A--2A...->
 * 
 *  i2: ----0----1----2...->
 *  i2Map: ----0B----1B----2B...->
 * 
 *  merge: --0A--(0B & 1A)--2A--(1B & 3A)--4A--(2B & 5A)...->
 * 
 *  - Mergeçš„åŒæ­¥é™æµï¼Œmergeå¯ä»¥æ¥æ”¶ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œç”¨æ¥è¡¨ç¤ºåˆå¹¶çš„Observableæ•°é‡ï¼Œå¦‚ä¸‹ï¼š
 *  o1 = interval(500).take(3)
 *  o2 = interval(600)
 *  o3 = interval(800)
 *  source$ = o1.pipe(merge(o2, o3, 2))
 *  æˆ‘ä»¬æŒ‡å®šåˆå¹¶æ•°é‡ä¸º2ï¼Œæ­¤æ—¶o3å°†ä¸ä¼šå¾—åˆ°è¿›å…¥mergeçš„æœºä¼šï¼Œåªæœ‰å½“o1çš„æ•°æ®æµå¤„ç†ç»“æŸåï¼Œæ‰ä¼šè½®åˆ°o3
 * 
 *  - åº”ç”¨åœºæ™¯ï¼šå¦‚è®¸å¤šäº‹ä»¶å¯ä»¥ä½¿ç”¨åŒä¸€ä¸ªå¤„ç†å‡½æ•°çš„æƒ…å†µï¼Œæ¯”å¦‚DOMçš„touchendä¸clickäº‹ä»¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥
 *  merge(
 *    fromEvent(element, 'click'),
 *    fromEvent(element, 'touchend')
 *  ).subscribe(handler)
 *  è¿™æ ·æ— è®ºè§¦å‘çš„æ˜¯å“ªä¸ªæˆ‘ä»¬éƒ½ä½¿ç”¨åŒä¸€ä¸ªæ–¹æ³•æ¥å¤„ç†äº†ã€‚
 */
var oaMerge$ = merge(
  interval(500).pipe(map(v => v + 'A')),
  interval(1000).pipe(map(v => v + 'B'))
)
// oaMerge$.subscribe(outilObserver)

/**
 * 3ã€Zipï¼šé¡¾åæ€ä¹‰ï¼Œå°±åƒæ‹‰é“¾ä¸€æ ·è¿›è¡Œç»„åˆï¼Œä¸€å¯¹ä¸€å¯¹çš„å¡åˆä½ã€‚åœ¨å¼‚æ­¥æ•°æ®æµçš„æƒ…å†µä¸‹ï¼Œzipæ¥æ”¶åˆ°ä¸€ä¸ªæ•°æ®è€Œå¦ä¸€ä¸ªæ•°æ®è¿˜æœªå‡ºç°æ—¶ï¼Œä¼šè¿›è¡Œç­‰å¾…ï¼Œç­‰åˆ°å…¶å‡ºç°åå†è¿›è¡Œç»„åˆ
 * ä¾‹å¦‚ä¸‹é¢çš„ï¼š
 * of: (1, xzx, 2)|->
 * interval: ----Zip----Zip----Zip...->
 * Zip: ----[1, Zip]----[xzx, Zip]----[2, Zip]|->
 * 
 * Zipä¹Ÿæ”¯æŒå¤šæ¡Observableçš„åˆå¹¶ï¼Œä»–çš„æ•°é‡å°±åƒæœ¨æ¡¶çŸ­æ¿ç†è®ºä¸€æ ·ç”±æœ€çŸ­çš„æ¿å­ï¼ˆæœ€çŸ­çš„Observableå†³å®šï¼‰
 */
var oaZip$ = zip(
  oaOf$,
  interval(1000).pipe(map(v => 'Zip'))
)
// oaZip$.subscribe(outilObserver)

/**
 * 4ã€combineLatestï¼šå°†å„ä¸ªObservableçš„æœ€åçš„å€¼åˆå¹¶æˆä¸€ä¸ªï¼Œæ¥æ”¶å¤šä¸ªå‚æ•°ï¼Œå‰é¢n-1ä¸ªä¸ºObservableï¼Œæœ€åä¸€ä¸ªå‚æ•°ä¸ºcallbackï¼Œcallbackå‚æ•°æ•°é‡ç­‰äºæ‰€éœ€è¦åˆå¹¶çš„Observableæ•°é‡
 *      ğŸ‘€ï¼šå…¶åŸåˆ™ä¸ºï¼Œå¿…é¡»ç­‰åˆ°å¾…åˆå¹¶çš„æ‰€æœ‰Observableéƒ½æœ‰å€¼é€å‡ºçš„æ—¶å€™æ‰ä¼šè°ƒç”¨callbackæ¥åå‡ºå€¼
 *      ğŸ‚ï¼šé€‚åˆå¤šå› å­ç»“æœè¿ç®—ï¼Œæ¯ä¸ªå› å­éƒ½ä¼šæ—¶æ—¶å˜åŒ–ï¼Œé€šè¿‡combineLatestï¼Œç¡®ä¿æˆ‘ä»¬èƒ½å¤Ÿæ¯æ¬¡å¾—åˆ°æœ€æ–°ç»“æœ
 * 
 * å¦‚ä¸‹çš„æ­¥éª¤å›¾ä¸ºï¼š
 * 1âƒ£ï¸ï¼šo2åå‡º0ï¼Œæ­¤æ—¶o1è¿˜æ²¡åå‡ºè¿‡å€¼ï¼Œä¸æ‰§è¡Œcallback
 * 2âƒ£ï¸ï¼šo1åå‡º0ï¼Œo2æœ€ååå‡ºå€¼ä¸º0ï¼Œ --> 0
 * 3âƒ£ï¸ï¼šï¼ˆåŒæ—¶ï¼‰o2åå‡º1ï¼Œo1æœ€åå€¼ä¸º0ï¼Œ --> 1
 * 4âƒ£ï¸ï¼šo2åå‡º2ï¼Œo1æœ€åå€¼ä¸º0ï¼Œ --> 2
 * 5âƒ£ï¸ï¼šo1åå‡º1ï¼Œo2æœ€åå€¼ä¸º2ï¼Œ --> 3
 * 6âƒ£ï¸ï¼šï¼ˆåŒæ—¶ï¼‰o2åå‡º3ï¼Œo1æœ€åå€¼ä¸º1ï¼Œ --> 4
 * 7âƒ£ï¸ï¼šo1åå‡º2ï¼Œo2æœ€åä¸º3ï¼Œ --> 5
 * 8âƒ£ï¸ï¼šo1åå‡º3ï¼Œo2æœ€åä¸º3ï¼Œ --> 6
 * 
 * å¼¹ç å›¾ï¼š
 * å¦‚               ----0----1----2----3|
 *                  --0--1--2--3|
 * combineLatest:   ----(0+0=0)(0+1=1)--(0+2=2)--(1+2=3)(1+3=4)----(2+3=5)----(3+3=6)|
 * 
 * - CombineLatestä¼šåœ¨æ‰€æœ‰OBservableéƒ½å®Œç»“åæ‰ä¼šå®Œç»“
 * - å†è¿›è¡ŒåŒæ­¥Observableæ—¶ï¼Œå°†ä¼šæå–ç¬¬ä¸€ä¸ªObservableçš„æœ€åå€¼ä¸å…¶ä»–Observableçš„å€¼è¿›è¡Œç»„åˆ
 *    è¿™æ˜¯å› ä¸ºCombineä¼šé¡ºåºè®¢é˜…æ‰€æœ‰ä¸Šæ¸¸Observableï¼Œä½†åœ¨å®ƒè®¢é˜…ç¬¬ä¸€ä¸ªObservableæ—¶ï¼ˆO1ï¼‰ï¼ŒO1å°±å·²ç»åå‡ºäº†å…¨éƒ¨æ•°æ®äº†ï¼Œæ‰€ä»¥å†è®¢é˜…åé¢çš„Oæ—¶ï¼Œå°±å°†è§¦å‘åˆå¹¶åå‡ºæœºåˆ¶ï¼ˆåªæœ‰ä¸¤ä¸ªOçš„æƒ…å†µä¸‹ï¼Œnä¸ªOçš„è¯å°†ä¼šå–å‰n-1ä¸ªOçš„æœ€æœ«å°¾å€¼ï¼Œä¸ç¬¬nä¸ªOçš„æ‰€æœ‰å€¼åŒ¹é…ï¼‰
 * 
 * - å°ç¼ºé™·ï¼ˆglitchï¼‰ï¼šå½“å‡ºç°å¤šé‡ä¾èµ–é—®é¢˜æ—¶
 *    å¦‚ï¼Œä¸¤ä¸ªOå…¶å®æ˜¯ä¾èµ–äºåŒä¸€ä¸ªOçš„ï¼Œ
 *    egï¼šO = interval(1000); O1 = O.map(v => v + 'a'); O2 = O.map(v => v + 'b')
 *      combineLatest(O1, O2)
 *    æ­¤æ—¶å°†ä¼šå¾—åˆ°ï¼š[0a, 0b], [1a, 0b], [1a, 1b]......
 *    è¿™é‡Œå°±æœ‰ä¸€ä¸ªé—®é¢˜åœ¨FRPçš„åŸæ—¨å®šä¹‰ä¸Šï¼Œè¿™ç§ä¾èµ–äºåŒä¸€ä¸ªOçš„æƒ…å†µï¼Œåå‡ºå€¼åº”è¯¥åªå’ŒOæœ‰å…³ï¼Œä¸åº”è¯¥å‡ºç°ä»¥ä¸Šçš„æƒ…å†µï¼Œåº”è¯¥æ˜¯
 *       [0a, 0b],[1a, 1b]...
 *    é¢å¯¹è¿™ä¸ªé—®é¢˜æˆ‘ä»¬ä½¿ç”¨withLastestFromå°±èƒ½å¾—åˆ°ä¸Šé¢çš„è¾“å‡º
 */
var oaCombineLatest = combineLatest(interval(1000), interval(500), (o1, o2) => `o1: ${o1} -- o2: ${o2}`)
// oaCombineLatest.subscribe(outilObserver)

/**
 * 5ã€withLastestFromï¼šåŠŸèƒ½ç±»ä¼¼äºä»–çš„å…„å¼ŸcombineLastestï¼Œä½†æ˜¯â¤ å®ƒç»™ä¸‹æ¸¸æ¨é€æ•°æ®åªèƒ½ç”±ä¸€ä¸ªä¸Šæ¸¸Observableæ¥æ§åˆ¶ï¼ˆè°ƒç”¨withLastestFromæ“ä½œç¬¦çš„å®ä¾‹ï¼‰ â¤
 *    æ‰€ä»¥å®ƒä¹Ÿåªæœ‰å®ä¾‹åŒ–æ“ä½œç¬¦ï¼Œè°ƒç”¨è€…å†³å®šæ˜¯å¦åå‡ºæ•°æ®ï¼Œå‚æ•°åªè´Ÿè´£è´¡çŒ®æ•°æ®äº†ã€‚
 *  
 *  å¦‚ä¸‹é¢çš„æ“ä½œï¼Œå°†åå‡º 101ï¼Œ203ï¼Œ305...
 *  å¼¹ç å›¾ï¼š O1$: 0----100----200----...
 *          O2$: -0--1--2--3--4--5--...
 * 
 *    è§£æï¼š
 *      â‘  O1åå‡º0æ—¶ï¼ŒO2è¿˜æ²¡æ•°æ®ï¼Œæ‰€ä»¥å¹¶æœªè§¦å‘Project
 *      â‘¡ O2åå‡º0ï¼Œä½†æ˜¯O2æ²¡æœ‰æ§åˆ¶æƒï¼Œæ‰€ä»¥ä¹Ÿæ²¡è§¦å‘projectåå‡ºæ•°æ®
 *      â‘¢ O2åå‡º1
 *      â‘£ O1åå‡º100ï¼ŒO2æ­¤æ—¶æœ€åçš„å€¼ä¸º1ï¼Œè§¦å‘projectç»„åˆæœª 101
 *      ...
 */
var O1$ = timer(0, 2000).pipe(map(v => v * 100))
var O2$ = timer(500, 1000)
var oaWithLastestFrom = O1$.pipe(withLatestFrom(O2$, (a, b) => a + b))
// oaWithLastestFrom.subscribe(outilObserver)

/**
 * 6ã€raceï¼šé¡¾åæ€ä¹‰ï¼Œç«é€Ÿï¼å¤šä¸ªObservableåœ¨ä¸€èµ·ï¼Œçœ‹è°æœ€å…ˆäº§ç”Ÿæ•°æ®ï¼Œèƒœè€…é€šåƒï¼Œè´¥è€…å¤±å»æ‰€æœ‰æœºä¼šï¼Œraceå°†ä¼šå…¨ç›˜é‡‡ç”¨èƒœè€…çš„æ•°æ®æµï¼Œé€€è®¢è´¥è€…çš„ã€‚
 *    ä¸‹é¢çš„ä¾‹å­Aæœ€å…ˆåå‡ºæ•°æ®ï¼Œæ‰€ä»¥æœ€ç»ˆç»“æœå–Aï¼šA0ã€A1ã€A2...
 */
var oaRace = race(timer(0, 2000).pipe(map(v => 'A' + v)), timer(500, 500).pipe(map(v => 'B' + v)), timer(50, 100).pipe(map(v => 'C' + v)))
// oaRace.subscribe(outilObserver)

/**
 * 7ã€startWithï¼šä¹Ÿåªæœ‰å®ä¾‹æ“ä½œç¬¦çš„å½¢å¼ï¼ŒåŠŸèƒ½æ˜¯è®©ä¸€ä¸ªObservableå¯¹è±¡åœ¨è®¢é˜…æ—¶ï¼Œæ€»æ˜¯å…ˆï¼ˆåŒæ­¥ï¼‰åå‡ºæŒ‡å®šçš„è‹¥å¹²ä¸ªæ•°æ® ===> ç­‰äºè¯´åŠ å¡ä¸€äº›æ•°æ®åœ¨Observableå‰é¢
 *    ä¸è¶³ä¹‹å¤„æ˜¯ä»–çš„æ‰€æœ‰åŠ å¡æ•°æ®åªèƒ½æ˜¯åŒæ­¥åå‡ºçš„ï¼Œæƒ³è¦å¼‚æ­¥çš„è¯å’±è¿˜å¾—ç”¨concat
 */
var oaStartWith = interval(1000).pipe(startWith('xzx', 'ldl', 'zyq'))
// oaStartWith.subscribe(outilObserver)

/**
 * 8ã€forkJoinï¼šåªæœ‰é™æ€æ“ä½œç¬¦ã€‚
 *    forkJoinæ¥æ”¶å¤šä¸ªObservableï¼Œå½“è¿™äº›Observableå…¨éƒ¨ç»“æŸåï¼Œå°†ä»–ä»¬çš„æœ€åä¸€ä¸ªå€¼åˆå¹¶å‘é€åˆ°ä¸‹æ¸¸ã€‚
 *    ç±»ä¼¼äºRxJSç•Œçš„Promise.all
 * 
 * ä¸‹é¢çš„ä¾‹å­ï¼š
 * interval: --0--1--2--3--4|->
 * timer: --0----1----2----3----4----5|->
 * of: '1' & 'xzx' & '2'|->
 * 
 * forkJoin: ----------------------[4, 5, '2']|->
 */
var oaForkJoin = forkJoin(
  interval(500).pipe(take(5)),
  timer(500, 1000).pipe(take(6)),
  oaOf$
)
// oaForkJoin.subscribe(outilObserver)




//  -------------------------------------------------------------------------------é«˜é˜¶Observable----------------------------------------------------------------------------
/**
 * é«˜é˜¶Observableï¼š
 *    å®šä¹‰ï¼šå³åå‡ºçš„æ•°æ®å†…å®¹ä¾ç„¶æ˜¯Observableçš„Observable
 *    - é«˜é˜¶Observableäº§å‡ºçš„æ•°æ®ä¹Ÿå«â€œå†…éƒ¨Observableâ€ï¼Œå› ä¸ºä»–ä»¬ä¸€èˆ¬ä¹Ÿä¸å±•ç¤ºåœ¨å¤–ã€‚
 *    - é«˜é˜¶Observableçš„å®Œç»“ä¸ä»£è¡¨å…¶å†…éƒ¨Observableçš„å®Œç»“ï¼Œå†…éƒ¨Observableæœ‰ç€è‡ªå·±çš„ç”Ÿå‘½å‘¨æœŸã€‚
 * 
 *    æ„ä¹‰ï¼š
 *    - èƒ½å¤Ÿç”¨Observableæ¥ç®¡ç†å¤šä¸ªObservableå¯¹è±¡
 */   
