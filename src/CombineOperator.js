const Rx = require('rxjs/Rx')
const Observable = Rx.Observable
/**
 * åˆå¹¶æ“ä½œç¬¦ï¼šâœ¨â¤ï¸
 */
let oaInterval = Observable.interval(1000).take(4)
let oaOf = Observable.of(1, 2, 3)
let oaFrom = Observable.from(['xzx', 'ldl', 'zyq'])

// 1.concatAllï¼šæœ‰çš„æƒ…å†µä¸‹Observableé€å‡ºçš„å…ƒç´ è¿˜æ˜¯ä¸€ä¸ªObservableï¼Œæ­¤æ—¶å°±åƒä¸€ä¸ªäºŒç»´æ•°ç»„ï¼ŒconcatAllå³ç±»ä¼¼Array.concatå°†å…¶æ‘Šå¹³
//          æ³¨ï¼šconcatAllä¼šå…ˆå¤„ç†å…ˆå‡ºçŽ°çš„observableï¼Œåªæœ‰ç­‰åˆ°è¿™ä¸ªobservableå¤„ç†å®Œæ¯•åŽæ‰ä¼šå¤„ç†ä¸‹ä¸€ä¸ªobservableï¼Œæ‰€ä»¥å¦‚æžœäºŒç»´æ•°ç»„å†…çš„
//             obervableä¸ºå¼‚æ­¥çš„ï¼Œå†ç»è¿‡å…¶å¤„ç†åŽä¼šå˜å¾—æ•´ä½“åƒæ˜¯åŒæ­¥çš„ --> å³å¯è®¤ä½œå…¶ç»„åˆæ–¹å¼ä¸ºç›´æŽ¥é¦–å°¾ç›¸è¿žæŽ¥
let oaConcatAll = Observable.interval(1000).map(v => Observable.of(1, 2, 3)).concatAll()
// oaConcatAll.subscribe(console.log)
/* ----(123)----(123)----....... */

// 2.concatï¼šå°†å¤šä¸ªobservableåˆå¹¶æˆä¸€ä¸ªã€‚
//          âš ï¸æ³¨æ„ï¼šconcatåˆå¹¶åŽŸåˆ™ä¸ŽconcatAllä¸€æ ·ï¼Œéƒ½æ˜¯æ”¶å°¾åˆå¹¶ï¼Œæ‰€ä»¥åœ¨ä¸‹é¢çš„æ —å­ä¸­ï¼Œå…ˆæ˜¯çœ‹åˆ°'concat --> 'è¢«æ‰“å°ï¼ŒæŽ¥ç€ä¾¿æ˜¯---0---1---...å³oaIntervalçš„å†…å®¹ï¼Œè€ŒåŽé¢çš„oaOfä¸ŽoaFroméœ€è¦ç­‰å¾…oaIntervalçš„1000å„æ•°å­—è¾“å‡ºå®Œæ‰ä¼šå¼€å§‹
//          ðŸ†•æç¤ºï¼šconcatä¹Ÿèƒ½å½“ä½œä¸€ä¸ªé™æ€æ–¹æ³•æ¥ä½¿ç”¨æ— éœ€å®žä¾‹åŒ–ï¼ša = Observable.concat(oa1, oa2, oa3)
let oaConcat = Observable.of('concat --> ').concat(oaInterval, oaOf, oaFrom)
// oaConcat.subscribe(console.log)

// 3.startWithï¼šèƒ½å¤Ÿåœ¨observableå¼€å§‹å‰å¡žå…¥å…¶ä»–å…ƒç´ ï¼Œå‚æ•°ä¸ºå…¶ä»–å…ƒç´ ï¼ˆéžobservableï¼‰ï¼Œå¡žå…¥å…ƒç´ åŒæ­¥åå‡º ---> å¸¸ç”¨äºŽä¿å­˜ç¨‹åºçš„å…¶å®žçŠ¶æ€
let oaStartWith = oaInterval.startWith('start With -> ')
// oaStartWith.subscribe(console.log)

// 4.mergeï¼šåŠŸèƒ½ä¸Šç±»åŒconcatï¼Œäº¦ä¸ºåˆå¹¶ï¼Œä½†å…¶åˆå¹¶åŽŸåˆ™å´å®Œå…¨ä¸åŒ
//          ðŸ‘“ï¼šmergeå°†ä¼šåŒæ—¶å¤„ç†éœ€è¦åˆå¹¶çš„å¤šä¸ªObservableï¼ŒæŒ‰ç…§å®ƒä»¬åå‡ºå€¼çš„æ—¶é—´æ¥åˆå¹¶å¹¶å°†å€¼æœ‰åºåå‡ºï¼ˆå³ï¼Œå¹¶éžç®€å•é¦–å°¾ç›¸æŽ¥äº†ï¼‰--> ä»–çš„é€»è¾‘æœ‰ç‚¹åƒOR
//          ðŸ‘“ï¼šmergeåŒæ ·å¯ä»¥å½“åé™æ€æ–¹æ³•ä½¿ç”¨ï¼Œä»–å°†ä¼šåœ¨mergeçš„Observableéƒ½ç»“æŸåŽç»“æŸ
//          å¦‚ä¸‹ï¼š
//          oaInterval: ----0----1----2----3----...
//          merge(xxx): --0--1--2--3--...
//          oaMerge:    --0--(01)--2--(13)--...
let oaMerge = oaInterval.merge(Observable.interval(500))
// oaMerge.subscribe(console.log)

// 5.combineLatestï¼šå°†å„ä¸ªObservableçš„æœ€åŽçš„å€¼åˆå¹¶æˆä¸€ä¸ªï¼ŒæŽ¥æ”¶å¤šä¸ªå‚æ•°ï¼Œå‰é¢n-1ä¸ªä¸ºObservableï¼Œæœ€åŽä¸€ä¸ªå‚æ•°ä¸ºcallbackï¼Œcallbackå‚æ•°æ•°é‡ç­‰äºŽæ‰€éœ€è¦åˆå¹¶çš„Observableæ•°é‡
//                 ðŸ‘€ï¼šå…¶åŽŸåˆ™ä¸ºï¼Œå¿…é¡»ç­‰åˆ°å¾…åˆå¹¶çš„æ‰€æœ‰Observableéƒ½æœ‰å€¼é€å‡ºçš„æ—¶å€™æ‰ä¼šè°ƒç”¨callbackæ¥åå‡ºå€¼
//                 ðŸ‚ï¼šé€‚åˆå¤šå› å­ç»“æžœè¿ç®—ï¼Œæ¯ä¸ªå› å­éƒ½ä¼šæ—¶æ—¶å˜åŒ–ï¼Œé€šè¿‡combineLatestï¼Œç¡®ä¿æˆ‘ä»¬èƒ½å¤Ÿæ¯æ¬¡å¾—åˆ°æœ€æ–°ç»“æžœ
//     å¦‚               ----0----1----2----3|
//                      --0--1--2--3|
//     combineLatest:   ----(0+0=0)(0+1=1)--(0+2=2)--(1+2=3)(1+3=4)----(2+3=5)----(3+3=6)|
/**
 * 1âƒ£ï¸ï¼šo2åå‡º0ï¼Œæ­¤æ—¶o1è¿˜æ²¡åå‡ºè¿‡å€¼ï¼Œä¸æ‰§è¡Œcallback
 * 2âƒ£ï¸ï¼šo1åå‡º0ï¼Œo2æœ€åŽåå‡ºå€¼ä¸º0ï¼Œ --> 0
 * 3âƒ£ï¸ï¼šï¼ˆåŒæ—¶ï¼‰o2åå‡º1ï¼Œo1æœ€åŽå€¼ä¸º0ï¼Œ --> 1
 * 4âƒ£ï¸ï¼šo2åå‡º2ï¼Œo1æœ€åŽå€¼ä¸º0ï¼Œ --> 2
 * 5âƒ£ï¸ï¼šo1åå‡º1ï¼Œo2æœ€åŽå€¼ä¸º2ï¼Œ --> 3
 * 6âƒ£ï¸ï¼šï¼ˆåŒæ—¶ï¼‰o2åå‡º3ï¼Œo1æœ€åŽå€¼ä¸º1ï¼Œ --> 4
 * 7âƒ£ï¸ï¼šo1åå‡º2ï¼Œo2æœ€åŽä¸º3ï¼Œ --> 5
 * 8âƒ£ï¸ï¼šo1åå‡º3ï¼Œo2æœ€åŽä¸º3ï¼Œ --> 6
 */
let oaCombineLatest = oaInterval.combineLatest(Observable.interval(500).take(4), (x, y) => x + y)
// oaCombineLatest.subscribe(console.log)

// 6.zipï¼šé¡¾åæ€ä¹‰ï¼Œæ‹‰é“¾ï¼Œzipçš„åˆå¹¶åŽŸåˆ™å°±è·Ÿæ‹‰é“¾ä¸€æ ·ï¼Œå®ƒä¼šå°†ç›¸åŒä½åºçš„å…ƒç´ è¿›è¡Œåˆå¹¶ï¼ˆæ— è®ºæ—¶é—´ï¼‰å¹¶ä¼ å…¥callbackã€‚ä¸”å…¶å°†åœ¨å–å®Œæœ€å°‘å…ƒç´ çš„ObservableåŽç»“æŸ
//        å…¶å‚æ•°è·ŸcombineLatestä¸€æ ·ï¼Œzipå¾ˆå®žç”¨é€šå¸¸èƒ½ç”¨æ¥å°†åŒæ­¥çš„æ•°æ®å˜æˆå¼‚æ­¥é€å‡ºï¼šObservable.interval(100).zip(Observable.of('xzx','ldl','zyq'), (x, y) => y)å³æ¯éš”100msé€å‡ºofå†…çš„ä¸€æ®µæ•°æ®ï¼Œé€å®Œä¸ºæ­¢
/**
 * o1: ----0----1----2----3|
 * o2: --0--1--2|
 * zip: ----(o1[0]+o2[0]=0)----(o1[1]+o2[1]=2)----(o1[2]+o2[2]=4)|
 */
let oaZip = oaInterval.zip(Observable.interval(500).take(3), (x, y) => x + y)
// oaZip.subscribe(console.log)

// 7.withLatestFromï¼šä¸ŽcombineLatestç›¸ä¼¼ï¼Œä½†æœ‰â€˜ä¸»ä»Žå…³ç³»â€™ï¼Œåªæœ‰å†ä¸»Observableé€å‡ºå€¼æ—¶æ‰ä¼šæ‰§è¡Œcallbackï¼Œä»ŽObservableçº¯å½“èƒŒæ™¯æ¿ç”¨æ¥ç»™å‚æ•°çš„
/**
 * o1: ------0------1------2------3------4------...
 * o2: ----0----1----2----3|
 * result: ------0------'1xx'------2------...
 * 1âƒ£ï¸ï¼š1.5såŽo1é€å‡º0ï¼Œo2ä¸Šä¸€æ¬¡å€¼ä¸º0 --> x
 * 2âƒ£ï¸ï¼š3såŽo1é€å‡º1ï¼Œo2ä¸Šä¸€æ¬¡å€¼ä¸º1ï¼ˆå› ä¸ºå…ˆé€å‡ºçš„æ˜¯o1ï¼Œå®ƒåŒ¹é…çš„å…¶å®žæ˜¯2sæ—¶o2é€å‡ºçš„å€¼1ï¼Œåˆ™åœ¨æ‰§è¡Œå®ŒåŽo2æ‰é€å‡º2ï¼‰--> x'xx'
 * ...ä»¥æ­¤ç±»æŽ¨
 *
 * å¸¸ç”¨äºŽåšä¸€äº›æ»¤è¿‡çš„ä¸œè¥¿ï¼Œå¦‚ç¼–è¾‘å™¨ï¼Œo1å°±æ˜¯å•çº¯çš„è¾“å…¥æ–‡å­—ï¼Œo2åˆ™ä¸ºæ ·å¼çš„è®¾ç½®ï¼Œå½“å°†æ ·å¼è®¾ä¸ºç²—ä½“æ—¶ï¼Œè¾“å‡ºçš„å°±æ˜¯ç²—ä½“ï¼Œè®¾ä¸ºæ–œä½“è¾“å‡ºçš„å°±æ˜¯æ–œä½“
 */
let oaWithLatestFrom = Observable.interval(1500).withLatestFrom(oaInterval, (x, y) => y === 1 ? x+'xx' : x)
// oaWithLatestFrom.subscribe(console.log)

// 8.