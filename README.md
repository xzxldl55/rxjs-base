# rxjsðŸ‚ðŸºbase

## ä¸‰ä¸ªç‰¹æ€§ï¼š
- å£°æ˜Žå¼ç¼–ç¨‹
- çº¯å‡½æ•°ï¼š
  - ä¸æ”¹å˜å…¨å±€å˜é‡å€¼
  - ä¸æ”¹å˜è¾“å…¥å‚æ•°å¼•ç”¨çš„å¯¹è±¡
  - ä¸è¯»å–ç”¨æˆ·è¾“å…¥ï¼ˆegï¼šalertï¼Œconfirmï¼‰
  - ä¸æ“ä½œDOM
  - ...
  - é‡è¦çš„ä¸€ç‚¹ç†è§£æ˜¯ï¼šçº¯å‡½æ•°åšçš„äº‹æƒ…å°±æ˜¯è¾“å…¥å‚æ•°åˆ°è¿”å›žç»“æžœçš„ä¸€ä¸ªæ˜ å°„ï¼Œä¸äº§ç”Ÿå‰¯ä½œç”¨
- æ•°æ®ä¸å¯å˜ï¼ˆImmutableæ•°æ®ï¼‰ï¼šä¿æŒåŽŸæœ‰æ•°æ®ä¸å˜ï¼Œäº§ç”Ÿæ–°çš„æ•°æ®

- **ä¸€ä¸ªæ ¸å¿ƒä¸‰ä¸ªé‡ç‚¹ï¼šObservable+Observer+Subject+Scheduler**

## å¼¹ç å›¾

- è§„åˆ™ï¼š
  - `-`ï¼šå°æ®µæ—¶é—´
  - `X`ï¼šé”™è¯¯
  - `|`ï¼šobservableç»“æŸ
  - `()`ï¼šä»£è¡¨åŒæ­¥å‘ç”Ÿ
  - eg:

```pseudoscope
// Rx.Observable.interval(1000):
----0----1----2----3----...
// Rx.Observable.of(1,2,3,4)
(1234)|
```

## Observableç‰¹æ€§ï¼š

- æ¸è¿›å¼å–å€¼ï¼šæ¯æ¬¡éƒ½åªå¤„ç†ä¸€ä¸ªObservableæµ
- å»¶è¿Ÿè¿ç®—ï¼šè®¢é˜…ä¹‹åŽæ‰ä¼šè¿›è¡Œè¿ç®—
- Observer Pattern && Iterator Patternä¸¤ç§æ¨¡å¼æ€æƒ³çš„ç»“åˆï¼Œå…·å¤‡ç”Ÿäº§è€…æŽ¨é€èµ„æ–™ï¼ŒåˆåŒæ—¶èƒ½å¤Ÿåƒä¸€ä¸ªIteratoråºåˆ—ä¸€æ ·æ‹¥æœ‰å¤„ç†åºåˆ—çš„æ–¹æ³•ï¼ˆMap, filter, reduce...ï¼‰

## Hot Observable && Cold Observableï¼š
- Hot Observableï¼šå³æ‰€æœ‰observerè§‚æµ‹çš„éƒ½æ˜¯åŒä¸€æ¡ä¸è¢«å…¶å½±å“çš„æ•°æ®æµï¼ˆObservableä¸ŽObserverç‹¬ç«‹å¼€æ¥ï¼Œä¸è¢«Observerå½±å“ï¼‰ï¼Œå¦‚æˆ‘ä»¬çœ‹ç”µè§†çš„æ—¶å€™ï¼Œæ‰“å¼€ç”µè§†ï¼ˆObservableï¼‰ï¼Œç”µè§†æ”¾åˆ°ä»€ä¹ˆèŠ‚ç›®å°±æ˜¯ä»€ä¹ˆèŠ‚ç›®ï¼Œä¸ä¼šè¯´æŸä¸ªäººæ‰“å¼€ï¼Œç”µè§†å°±è¦é‡æ–°å¼€å§‹æ”¾ã€‚
- Cold Observableï¼šä¸Žä¸Šé¢ç›¸åï¼Œå°±æ˜¯æ¯ä¸€æ¬¡Observerçš„è®¢é˜…èŽ·å–åˆ°çš„æ•°æ®æµéƒ½æ˜¯ä¸€æ ·çš„å®Œæ•´çš„ï¼Œä¸ä¼šå› ä¸ºè°åŽè®¢é˜…è€Œä¸¢å¤±æŽ‰å‰é¢åå‡ºçš„æ•°æ®ã€‚å°±åƒçœ‹è§†é¢‘ç½‘ç«™æ—¶ï¼Œæˆ‘ä»¬èƒ½å¤Ÿéšæ—¶ç‚¹æ’­è§†é¢‘ã€‚

## æ–°å¢žæ“ä½œç¬¦
- 1ã€æ‰“è¡¥ä¸ï¼šå³ç›´æŽ¥å¯¹Observable.prototype/Observableè¿›è¡Œæ“ä½œï¼Œå°†å®žä¾‹æ–¹æ³•æˆ–è€…é™æ€æ–¹æ³•æ·»åŠ ä¸ŠåŽ»ï¼ˆæ³¨æ„ä¸è¦ä¹±ç”¨ç®­å¤´å‡½æ•°ï¼Œå› ä¸ºthisï¼‰ --> Ã—æžå…¶ä¸æŽ¨èï¼Œå› ä¸ºä¼šäº§ç”Ÿå¯¹å…¨å±€Observableçš„æ±¡æŸ“
- 2ã€ä½¿ç”¨Bindç»‘å®šç‰¹å®šçš„Observableå¯¹è±¡ï¼šä¸Šé¢æ‰“è¡¥ä¸çš„æ–¹æ³•ä¼šå½±å“åˆ°å…¨å±€çš„Observableï¼Œè€Œä½¿ç”¨bindåˆ™èƒ½å¤Ÿä»…ä»…åªå¯¹æŸäº›Observableå®žä¾‹å¯¹è±¡è¿›è¡Œæ“ä½œç¬¦æ”¹é€ æˆ–æ·»åŠ ã€‚ä½†ä½¿ç”¨bindä¼šå¯¼è‡´æ²¡æ³•é“¾å¼è°ƒç”¨äº†ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç»‘å®šæ“ä½œç¬¦`::`æ¥è§£å†³
- 3ã€ä½¿ç”¨liftå‡½æ•°ï¼šliftæ˜¯ä¸€ä¸ªå®žä¾‹å‡½æ•°ï¼Œå®ƒä¼šè¿”å›žä¸€ä¸ªæ–°çš„Observableå¯¹è±¡ï¼Œé€šè¿‡ä¼ é€’ç»™liftçš„å‡½æ•°å‚æ•°èƒ½å¤Ÿèµ‹äºˆè¿™ä¸ªæ–°çš„Observableå¯¹è±¡ç‰¹æ®ŠåŠŸèƒ½
```
// æ‰“è¡¥ä¸
Observable.prototype.map = function (func) {
  return new Observable(observer => {
    // è‡ªåŠ¨è®¢é˜…ä¸Šæ¸¸
    const sub = this.subscribe({
      next: v => observer.next(func(v)),
      error: error => observer.error(error),
      complete: () => observer.complete()
    })
    // å½“è§‚å¯Ÿè€…è§£ç»‘æ—¶ï¼Œè‡ªåŠ¨æ‰§è¡Œè§£ç»‘
    return {
      unsubscribe: () => sub.unsubscribe()
    }
  })
}

Observable.of(1,2,3).map(v => v * 2).subscribe(console.log)

// bind
const map = function (func) {....}

const operator = map.bind(source$)
const result = operator(x => x+1)

// ç»‘å®šæ“ä½œç¬¦
const result$ = source$::map(x => x+1)::map(x => x*2).filter(...) // ä¸”è¿˜èƒ½ä¸Ž.æ“ä½œç¬¦æ··ç”¨


```

## æ“ä½œç¬¦çš„å¯¼å…¥
- 1ã€æ‰“è¡¥ä¸å¯¼å…¥ï¼š`import 'rxjs/add/operator/map'`æˆ–`import 'rxjs/add/observable/of`ï¼Œç”¨æ¥ç›´æŽ¥å¯¼å…¥å®žä¾‹æ–¹æ³•æˆ–é™æ€æ–¹æ³•ï¼Œå…¶å®žï¼Œè¿™ä¸¤ä¸ªæ–‡ä»¶å†…éƒ¨å¹¶æ²¡æœ‰å¯¹ç›¸å¯¹åº”æ“ä½œç¬¦çš„å®šä¹‰ï¼Œè€Œåªæ˜¯ä»Žåˆ«å¤„å¼•å…¥æ“ä½œç¬¦å®šä¹‰å‡½æ•°ï¼Œå¹¶å°†å…¶æ‰“è¡¥ä¸åˆ°äº†Observableä¸Šé¢ï¼Œå¯è§`'rxjs/add/operator/map'`çš„ä»£ç ï¼š
```
var rxjs_1 = require("rxjs");
var map_1 = require("../../operator/map");
rxjs_1.Observable.prototype.map = map_1.map;
// ä»…ä»…æ˜¯å°†mapæ‰“è¡¥ä¸åˆ°äº†rxjsä¸Š
```
- 2ã€å‡½æ•°å¯¼å…¥ï¼šå‡½æ•°å¯¼å…¥å°±æ˜¯ä¸Šé¢æ‰“è¡¥ä¸æ–‡ä»¶é‡Œé¢æ‰€å¯¼å…¥çš„å‡½æ•°äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¹Ÿéœ€è¦å¯¹å…¶å‘½åï¼Œåœ¨ä½¿ç”¨æ—¶ä½¿ç”¨å…¶å˜é‡åï¼Œä»–ä»¬çš„åŒºåˆ«å°±æ˜¯æ‰“è¡¥ä¸æ˜¯ä»Ž`'rxjs/add/xxx'`å¯¼å…¥çš„ï¼Œè€Œå‡½æ•°å¯¼å…¥ç›´æŽ¥ä»Ž`'rxjs/xxx'`å¯¼å…¥
```
import {map} 'rxjs/operator/map'
import {of} 'rxjs/observable/of'

const source$ = of(1,2,3)
const source$2 = source$::map(x=>x+1) // è¿™é‡Œè¦ä½¿ç”¨ç»‘å®šæ“ä½œç¬¦ï¼Œå› ä¸ºmapæ˜¯ä½œä¸ºä¸€ä¸ªå•ç‹¬çš„å‡½æ•°å¯¼å…¥çš„ï¼Œå¹¶æ²¡æœ‰æŒ‚è½½åˆ°Observableå®žä¾‹ä¸Šé¢å’¯ã€‚
```

- 3ã€æ”¯æŒTree Shakingçš„lettable && pipeableï¼ˆæœ¬æ¥å«lettableï¼Œä½†æ˜¯ä¸å¥½ç†è§£æ”¹æˆäº†pipeableï¼‰ï¼šå¯¼å…¥ç›®å½•æ”¹ä¸ºäº† `'rxjs/operators/xx'` ï¼ˆæ³¨ï¼šæ˜¯operatorsæ˜¯å¤æ•°ï¼ï¼‰
  - pipeableæ˜¯ä¸€ç§ä½¿ç”¨æ“ä½œç¬¦çš„æ–¹å¼ï¼Œå®ƒèƒ½å¤Ÿé…åˆTree shakingæ¥åˆ é™¤æ­»ä»£ç ï¼Œä¼˜åŒ–åŽ‹ç¼©
  - é™æ€æ“ä½œç¬¦æ²¡æœ‰lettableçš„å¯¹åº”å½¢å¼ï¼›æ‹¥æœ‰å¤šä¸ªä¸Šæ¸¸Observableå¯¹è±¡çš„æ“ä½œç¬¦æ²¡æœ‰å¯¹åº”çš„lettableå½¢å¼
  ```
  import {of} from 'rxjs/observable/of'
  import {map} from 'rxjs/operators' // è¿™é‡Œç›´æŽ¥å¯¼å…¥rxjs/operators/indexï¼Œå…¶å†…è‡ªåŠ¨å¯¼å…¥äº†æ“ä½œç¬¦çš„å¼•ç”¨

  const source$ = of(1,2,3)
  const result$ = source$.pipe(
    map(x => x * x)
  )
  result$.subscribe(console.log)
  ```
